#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <stdint.h>
#include <string.h>
#include <time.h>

#define MAX_PEAKS 1000
#define NUM_FEATURES 10
#define nl printf("\n")
int min(int a, int b)
{
    return a < b ? a : b;
}
int max(int a, int b)
{
    return a > b ? a : b;
}
double mean_values[] = {1.77753977e-01, 3.59352800e-01, 1.77753977e-01, -1.25828351e-04,
                        -3.44274046e-02, -5.39885462e-01, 9.15610009e+00, -8.25970172e+00,
                        -5.05256883e+00, 2.26730744e-01};

double std_values[] = {0.02787179, 0.10632374, 0.02787179, 0.05508058, 0.26507991, 0.13321061,
                       5.10752751, 4.15838362, 3.47513855, 0.13791729};
double weights_layer1[NUM_FEATURES][64] = {{-0.03168105, 0.14227319, -0.14316048, -0.25546563, -0.16457875, -0.29242936,
                                            0.247487, -0.05477563, 0.01007383, -0.2703608, 0.10040393, -0.15600978,
                                            -0.18296544, 0.2449598, -0.16993316, 0.11471271, 0.24400732, 0.14481847,
                                            0.19683413, -0.10958532, -0.11748233, -0.02662665, -0.16023582, -0.03504093,
                                            -0.15033789, 0.03111387, -0.26147076, -0.06834461, 0.05862129, -0.119985,
                                            -0.12132127, 0.17355002, 0.25501144, -0.28743374, 0.07375888, 0.18614975,
                                            -0.14248985, -0.20229343, -0.18141435, 0.06889177, 0.34284675, 0.27243719,
                                            -0.16894218, 0.24419378, -0.16884339, 0.15317522, 0.10465321, 0.18728548,
                                            0.02645949, -0.28013465, 0.15343474, -0.23609208, 0.29188094, 0.02643798,
                                            0.02597121, -0.21063997, 0.25059283, 0.1325668, 0.16537899, -0.22278464,
                                            0.09278394, -0.11531647, -0.17883164, -0.1224959},
                                           {0.03135659, 0.05313081, -0.05186632, -0.13290067, -0.18183887, 0.25870374,
                                            -0.02754702, -0.23649819, -0.02432918, 0.17248626, -0.16827817, -0.06673455,
                                            -0.17924927, -0.01465417, 0.12754545, -0.10671047, -0.1328629, -0.15453725,
                                            -0.33276653, 0.16869807, -0.07639138, -0.21343559, -0.22834857, 0.1676654,
                                            -0.06058853, 0.08188812, 0.10895229, 0.04495371, -0.26343182, 0.05978437,
                                            0.20329618, -0.2539743, -0.14019254, 0.00540832, -0.01016971, -0.06913406,
                                            0.22157356, -0.05256834, 0.17743045, 0.02744737, -0.40333688, -0.05876075,
                                            -0.09760064, -0.17702039, 0.07694335, -0.18323019, -0.03783253, 0.24285543,
                                            0.06681927, 0.04976846, -0.1713921, 0.02968038, -0.09845138, -0.01987219,
                                            -0.16107051, 0.20646302, -0.16604705, 0.07212225, -0.25882325, 0.04026468,
                                            0.03160425, 0.19771692, -0.2515741, 0.23832338},
                                           {-0.05033889, -0.10801341, 0.02003261, -0.22595519, 0.15735747, -0.01864621,
                                            0.22542542, -0.14351748, -0.10327873, -0.19531097, 0.14136742, -0.20921083,
                                            -0.10486944, -0.0285776, 0.04000138, -0.13553199, -0.02879674, 0.05117318,
                                            0.09526616, -0.0577162, -0.2355099, -0.1464043, 0.13164128, -0.1313119,
                                            0.19647379, 0.00390785, 0.07363896, -0.14755836, 0.27550277, -0.08034798,
                                            0.01941849, -0.00652204, 0.01469469, -0.23973829, 0.2651149, 0.08424013,
                                            -0.18969592, -0.1594381, 0.03424621, -0.04417386, -0.15049806, 0.07069385,
                                            -0.22602397, 0.14103092, -0.2811033, 0.18222047, 0.05868498, -0.27257192,
                                            0.06262375, -0.14033902, 0.21013857, 0.1169298, -0.1221827, -0.04333952,
                                            0.33349565, -0.1264377, -0.00558197, -0.1727645, 0.17176381, -0.02502506,
                                            0.16714516, -0.25331303, 0.26034638, 0.0988498},
                                           {0.13016948, -0.11683296, 0.13125387, 0.11030874, -0.22407997, -0.15430282,
                                            0.00966952, 0.01281784, -0.08878759, -0.25839844, -0.02433386, 0.1535866,
                                            0.09685268, 0.17469539, 0.00756001, -0.27740222, -0.105294, -0.18371084,
                                            -0.08156668, -0.13560615, -0.09987535, 0.06293344, 0.0088045, 0.14465787,
                                            0.18281032, -0.13571522, 0.10673618, -0.02711273, -0.10380598, 0.24582753,
                                            -0.22384338, -0.0730585, -0.14112486, -0.12051426, -0.16789863, -0.16321124,
                                            -0.0339302, 0.17310396, -0.17392951, -0.04642589, 0.14709218, 0.07364345,
                                            -0.24515072, 0.05546725, 0.16094378, 0.04606662, 0.26362947, 0.11927806,
                                            -0.1692371, 0.03187599, 0.14151792, 0.26384482, -0.09365825, 0.21471398,
                                            -0.10929072, -0.07317723, -0.2075624, 0.13692418, 0.1331326, -0.02983003,
                                            0.01677266, -0.19514595, 0.00651828, -0.13061468},
                                           {0.20253739, -0.11525237, -0.19083385, 0.12717909, 0.13787797, 0.23803991,
                                            -0.19326109, 0.20103821, 0.1389062, -0.1914741, 0.08929425, 0.04184408,
                                            0.1165073, -0.24748006, 0.09251592, 0.0478718, 0.10444432, -0.08330991,
                                            -0.09183381, -0.07870881, -0.03271203, 0.21783955, 0.02502677, -0.09233454,
                                            -0.04499228, -0.03818053, -0.20158212, 0.20879088, -0.18970776, 0.03521369,
                                            -0.1306284, 0.13152644, -0.01023491, 0.0479045, -0.16088782, -0.11971205,
                                            -0.14600101, -0.14719667, -0.24597077, -0.17024986, -0.04828186, 0.23033966,
                                            -0.31791434, 0.11376012, -0.04137326, 0.0238597, 0.1862319, 0.02842049,
                                            0.12397347, -0.10895599, 0.00206048, 0.13163982, 0.19084778, -0.074702,
                                            0.18451911, 0.17931454, -0.15456757, -0.16651371, -0.01616231, 0.11074524,
                                            0.19109152, 0.09403855, 0.07118472, 0.11823435},
                                           {-0.06698155, 0.00892435, 0.17452869, -0.28871477, -0.20633341, 0.20909376,
                                            0.2041029, 0.04361934, -0.03242792, 0.05665879, 0.01308015, -0.06669591,
                                            0.01190728, -0.08101791, 0.2590711, 0.2748267, -0.19258468, 0.2372908,
                                            0.11303354, -0.01890188, 0.14674714, -0.24616505, -0.0549893, 0.15869789,
                                            -0.03887776, -0.15359093, -0.267109, 0.02236523, 0.03202103, -0.2595065,
                                            0.01180753, 0.20432286, 0.1063548, -0.17520197, -0.10490642, 0.10989723,
                                            0.00496436, 0.09391483, -0.07465949, -0.19591977, -0.10478676, 0.16811329,
                                            -0.3053506, 0.01554446, -0.25357756, -0.03322394, 0.11946582, 0.27845988,
                                            0.05797082, -0.13728203, 0.33857447, -0.19176266, 0.07810456, -0.1457485,
                                            0.24845289, -0.18558387, -0.22528717, -0.00993527, 0.04878194, -0.18943316,
                                            -0.09631649, 0.0377946, -0.0651556, -0.11373449},
                                           {0.00054215, -0.08673953, 0.25484496, 0.08386272, -0.03951376, 0.09660314,
                                            -0.23991403, -0.16009982, -0.3054638, 0.13880257, -0.16739461, -0.08885226,
                                            -0.09115029, 0.14526065, -0.13364106, 0.20548508, -0.13165608, 0.20897889,
                                            0.14830193, -0.15273742, 0.05058349, -0.11540594, 0.28114143, -0.00919474,
                                            0.0395497, 0.21501969, -0.08089898, 0.00520262, -0.19894603, -0.2515172,
                                            -0.14834094, -0.06952309, 0.00408249, 0.08674663, 0.24350953, 0.02353307,
                                            0.17858474, 0.04901943, -0.04062453, 0.11310782, -0.31018263, 0.12669353,
                                            -0.11058872, -0.04199912, 0.05117691, -0.2312837, -0.0411211, 0.21110456,
                                            0.01598598, -0.08114999, -0.20152648, 0.15564382, -0.08588985, 0.09933075,
                                            0.23335442, -0.07316681, -0.18183123, -0.03413567, -0.10380612, 0.01273598,
                                            0.11833321, 0.00567665, 0.0239575, 0.21990222},
                                           {-0.16760188, 0.22548816, -0.21608718, -0.00639191, 0.07499421, -0.04232221,
                                            0.11613544, 0.14760177, -0.0360462, 0.26655707, -0.05512978, 0.1707319,
                                            0.23576571, 0.10612535, -0.05925109, 0.00386727, 0.2372479, -0.01990344,
                                            -0.05064132, 0.20142832, 0.09354448, -0.11014589, -0.14306745, 0.10341039,
                                            -0.14545526, -0.22758903, -0.02245566, -0.15337686, -0.09184573, -0.30360982,
                                            -0.21874811, 0.12562387, 0.12691906, 0.08281063, -0.24522482, 0.12455777,
                                            -0.06447213, -0.15947475, 0.0636038, 0.01321025, 0.02713213, -0.16800253,
                                            0.06228364, 0.21179657, 0.2618333, 0.23197852, -0.20414397, -0.14732252,
                                            0.25130072, 0.15369569, -0.16683418, 0.10804435, -0.05533316, -0.18988842,
                                            0.23253022, 0.2092591, 0.10983411, 0.12763464, -0.01461389, 0.06121979,
                                            -0.21246172, 0.14410526, 0.09572803, -0.01058451},
                                           {0.13249595, 0.00683627, 0.16472869, 0.0392632, -0.07400114, -0.19481786,
                                            -0.10687446, 0.19260122, -0.211907, 0.25761044, 0.14586031, -0.31503007,
                                            0.0465784, 0.018217, -0.0349215, 0.03828412, -0.15035361, -0.01133756,
                                            -0.12685949, -0.06271607, -0.2616866, 0.09987142, -0.01173317, -0.01058953,
                                            -0.07147583, 0.2342431, 0.11401504, 0.03300828, 0.2204238, 0.09511033,
                                            0.0617121, -0.08582331, 0.22725302, 0.08254832, -0.04403807, -0.17136902,
                                            0.05991429, -0.18472703, 0.10750549, 0.14455928, -0.27171355, 0.24499701,
                                            0.01351535, -0.00636419, 0.19198728, -0.11578848, 0.11195268, 0.0849407,
                                            -0.13149062, -0.05675141, 0.0449305, -0.24879478, -0.12334333, 0.06414213,
                                            0.0485422, -0.24256672, -0.01121689, -0.03968842, -0.30169624, 0.0237684,
                                            0.27382672, -0.16014342, 0.02900534, 0.10189433},
                                           {-0.13070382, 0.23801082, -0.13978371, 0.24164708, 0.14801832, -0.11602138,
                                            0.08996819, 0.02771044, 0.17563733, 0.09220502, 0.16699415, -0.04498512,
                                            0.28421155, 0.2227404, 0.19403552, 0.27171695, -0.13281757, -0.21422222,
                                            -0.28819236, 0.2247681, -0.23159127, -0.02506376, -0.18944676, -0.00955765,
                                            -0.05495286, -0.29206333, -0.08509873, -0.14600427, 0.05079418, 0.09701344,
                                            -0.1873851, 0.19489242, 0.26405895, 0.25574875, -0.2742707, 0.11700731,
                                            -0.22335577, -0.01993676, -0.17972958, 0.18121842, -0.02533852, -0.14455926,
                                            0.00180952, 0.09009555, -0.07313839, -0.12663086, -0.12666388, -0.10551834,
                                            -0.08740425, 0.07678264, 0.1078892, 0.09791747, -0.1584909, -0.25390872,
                                            0.19582923, -0.0740532, -0.09146058, -0.05316905, -0.21593401, 0.01547277,
                                            0.14191313, 0.1016712, -0.050439, 0.15639147}};

double biases_layer1[64] = {-0.05190047,
                            -0.09317981,
                            -0.01354485,
                            -0.0101742,
                            0.02947783,
                            -0.08149972,
                            -0.05895501,
                            -0.07211107,
                            -0.05101855,
                            -0.03729174,
                            0.03582425,
                            0.00066989,
                            -0.06306984,
                            -0.00747201,
                            -0.04598191,
                            0.00292034,
                            -0.0062053,
                            0.04284993,
                            0.04856417,
                            -0.0087749,
                            -0.01192464,
                            -0.04568719,
                            -0.00917589,
                            -0.04767232,
                            -0.10803102,
                            -0.05484555,
                            -0.04593334,
                            -0.06193095,
                            -0.0342681,
                            -0.00340751,
                            0.00956109,
                            -0.04104026,
                            -0.01839568,
                            -0.02811759,
                            -0.00933355,
                            -0.03895589,
                            0.04444103,
                            -0.12263007,
                            -0.05343127,
                            -0.07193656,
                            0.10498372,
                            -0.00752061,
                            0.06466743,
                            0.00701896,
                            0.03891482,
                            0.0274418,
                            -0.07128448,
                            -0.03059307,
                            -0.05663045,
                            -0.02492222,
                            0.0157829,
                            -0.11328143,
                            0.02828566,
                            0.02530895,
                            -0.00233728,
                            0.09984373,
                            -0.02946366,
                            -0.10597099,
                            0.05565852,
                            0.05100187,
                            -0.06835393,
                            0.01476259,
                            -0.05941424,
                            -0.07496087};

double weights_layer2[64][32] = {{0.16896479, 0.08616272, 0.06544337, 0.11932969, -0.25105467, 0.19558074,
                                  0.18482344, 0.23542301, 0.09829225, 0.06084703, 0.13250321, 0.01914578,
                                  0.06140078, 0.10943156, 0.18914692, 0.19123329, 0.17449494, -0.1956789,
                                  0.20029213, -0.2169489, -0.297531, -0.14399786, 0.15585046, -0.27028808,
                                  -0.22546704, 0.07181583, -0.14165008, 0.00289456, 0.15021439, 0.10292014,
                                  0.0870591, -0.02780817},
                                 {-0.00372337, -0.22241864, 0.07798419, -0.2630683, 0.08679914, 0.16289803,
                                  0.01852857, -0.02947075, 0.17285764, -0.05770933, 0.14513397, 0.22540234,
                                  -0.08139677, 0.14030866, 0.07267077, -0.16289407, 0.13131918, 0.12036268,
                                  0.17252111, 0.28738514, -0.1042318, 0.15960717, 0.08812696, 0.18349195,
                                  0.03807328, 0.12170452, -0.0288737, -0.02404591, -0.03063105, 0.07464567,
                                  -0.09545065, -0.14428383},
                                 {0.20342459, 0.15914322, -0.226982, -0.23136292, -0.10853392, 0.04120496,
                                  -0.16537222, -0.2303847, 0.16303515, 0.04922704, 0.13533376, 0.22788005,
                                  -0.07560799, 0.22770448, -0.1044962, -0.21092437, 0.04098767, 0.14367291,
                                  -0.2083015, -0.14328353, 0.11740198, -0.08984446, 0.06226011, 0.15878296,
                                  -0.14841476, -0.14078377, -0.11822292, 0.20190224, -0.22623819, -0.26690266,
                                  -0.01194946, -0.07075377},
                                 {-0.09083787, 0.01816437, -0.07157914, -0.07347255, 0.10184046, 0.2298007,
                                  -0.04718076, 0.19914871, 0.06440302, -0.0049644, -0.1902104, 0.24386881,
                                  0.02401039, 0.21147862, 0.03683869, 0.27245003, 0.12695843, -0.15034096,
                                  -0.00818837, -0.08560804, -0.05107982, 0.22768444, -0.2233977, -0.25524518,
                                  -0.20765461, -0.02448812, 0.1453414, -0.20044032, 0.08203489, -0.15511432,
                                  0.19754177, -0.08921213},
                                 {0.01729642, 0.04064451, 0.19958736, -0.18101643, -0.12984806, 0.13353996,
                                  -0.14821282, -0.00785228, -0.02113029, 0.1792876, -0.07157482, -0.12702288,
                                  0.00729277, -0.00730277, -0.21803902, -0.08777873, -0.16323309, -0.17282875,
                                  0.1609947, -0.10630723, -0.11073732, 0.02007562, -0.16490954, 0.01990842,
                                  0.1808867, -0.2575606, -0.18339963, -0.20700748, 0.1428949, -0.06594928,
                                  0.07697581, 0.0182502},
                                 {0.05093127, -0.2088754, -0.16434313, -0.22372633, -0.23397884, 0.02761703,
                                  -0.22827844, 0.2197162, -0.0043857, -0.18022329, 0.00795343, 0.20838547,
                                  0.10156512, -0.16221267, -0.00596318, 0.06558216, 0.12018246, -0.15468626,
                                  0.0157511, 0.16852295, -0.2222494, -0.1672212, 0.04129711, -0.17613448,
                                  -0.15616634, 0.11007064, -0.02350451, -0.23497882, -0.22767207, -0.00343918,
                                  0.1511175, -0.13674292},
                                 {0.09975671, -0.18006232, -0.21685037, 0.09437042, -0.17388885, -0.06763844,
                                  0.04951514, 0.08816992, 0.0036851, 0.2584901, -0.17244725, -0.21545173,
                                  -0.10595215, -0.05052713, -0.1670484, -0.2656026, -0.07541724, -0.18308645,
                                  -0.00075187, 0.19954489, 0.15325627, 0.04745665, -0.01451386, 0.15514432,
                                  -0.02484596, -0.03553494, 0.03328301, -0.20193619, -0.19244495, -0.09086552,
                                  -0.02193679, -0.20531969},
                                 {0.00455822, 0.02679359, 0.05331333, -0.05334403, 0.05466559, 0.10029272,
                                  0.06368877, 0.15933917, -0.02071643, -0.07551911, 0.13188095, 0.20509534,
                                  0.03119494, -0.07037935, -0.06903591, -0.03928202, 0.13210939, -0.17990741,
                                  -0.08536641, -0.12940608, 0.12150872, 0.03068682, 0.16398425, 0.09811081,
                                  -0.02603359, -0.21609843, 0.20917565, -0.13822989, 0.06703867, 0.06011873,
                                  0.01298769, -0.24531338},
                                 {0.03187947, 0.15620685, 0.22902681, -0.11668976, -0.12708662, -0.05891036,
                                  0.13114238, -0.14375035, -0.0377748, 0.08475203, -0.07701436, 0.01560999,
                                  -0.21114764, 0.16392724, 0.07931077, 0.02965793, 0.05159079, 0.02321676,
                                  -0.15426561, 0.05853297, 0.09954488, 0.18443617, -0.02662625, 0.13812771,
                                  -0.06089937, -0.21172386, -0.02288532, 0.05834254, 0.01974076, -0.00735668,
                                  0.2669742, -0.12566176},
                                 {-0.12229919, -0.22326773, -0.07065295, -0.02609251, -0.24797317, 0.06333088,
                                  0.13843922, -0.15797333, -0.08031303, 0.11093362, -0.11875981, -0.10724641,
                                  -0.17252345, 0.21280558, -0.04117278, 0.2495423, -0.18300085, 0.10886811,
                                  0.25733647, 0.32501376, -0.13341436, 0.17125316, 0.295094, 0.07428493,
                                  0.03957371, -0.17712791, -0.20107523, -0.09109553, -0.0727747, -0.26020807,
                                  -0.0940911, -0.15990154},
                                 {0.01086345, 0.12086406, -0.12663826, -0.08970184, 0.12119235, -0.03199724,
                                  0.0089859, -0.23360814, -0.27813888, -0.04573487, 0.17066266, -0.01504307,
                                  0.02120891, -0.13873258, -0.14783505, -0.2190991, 0.15312263, 0.2708851,
                                  0.09137136, -0.24894977, 0.06099117, 0.12123419, -0.07742061, 0.17190935,
                                  0.26831365, 0.14342608, -0.17154372, -0.09644233, 0.08284702, 0.05621255,
                                  -0.2452324, -0.05874162},
                                 {0.04721754, 0.15643628, -0.14163812, 0.09932164, -0.21777202, 0.07969104,
                                  -0.14996402, -0.11128781, 0.16149306, -0.1484787, 0.01929192, 0.19444537,
                                  0.00244197, 0.16500105, 0.05487724, 0.25558355, 0.11099479, 0.13326697,
                                  0.3099871, 0.29205298, 0.03796822, -0.04512421, -0.1302202, 0.11074843,
                                  -0.21366522, -0.02337987, -0.16402099, -0.27931035, 0.16247393, -0.1918243,
                                  0.28168193, -0.1198333},
                                 {0.01402573, 0.00148888, 0.16892055, 0.10127304, 0.14784165, -0.17580573,
                                  0.06076904, 0.20001557, 0.1483364, -0.17333569, 0.14347962, 0.16739678,
                                  0.06676335, -0.17252511, 0.17616956, -0.07095753, 0.1524363, 0.13750976,
                                  -0.10872156, -0.14848827, 0.09855068, 0.23626578, -0.13882987, -0.10566147,
                                  -0.01395629, 0.02099723, -0.27601707, -0.13218428, -0.1738774, 0.15836366,
                                  -0.15931828, 0.07435764},
                                 {-0.17808126, -0.05277934, 0.05350747, -0.1587924, 0.02634245, -0.06276521,
                                  0.21850002, 0.03138086, 0.1187285, -0.1209008, 0.03815689, 0.16715233,
                                  0.05549247, -0.14858837, -0.26345256, 0.05159543, -0.04929596, -0.08506487,
                                  -0.2626739, -0.16756807, 0.10448289, 0.15876761, 0.0623133, -0.2297585,
                                  -0.14291683, 0.10182302, 0.0603646, -0.21168192, 0.20000178, -0.22850293,
                                  -0.07346513, -0.18593633},
                                 {0.08059473, 0.0485388, -0.03532276, -0.22578524, -0.01837479, -0.21445182,
                                  -0.08054888, 0.27039117, -0.15583089, 0.17844094, 0.13695584, 0.07388532,
                                  0.14499083, 0.33076686, 0.01252383, 0.01036653, 0.23403944, -0.01885801,
                                  0.0374014, 0.07484208, 0.18044339, 0.07969707, 0.2326939, -0.21218604,
                                  -0.08362939, 0.19831647, -0.00298719, 0.16654904, -0.21993165, 0.16650803,
                                  0.15506321, -0.1320338},
                                 {-0.0084629, 0.02217559, -0.24467415, -0.17496228, 0.15777725, 0.07781902,
                                  -0.27843666, -0.23567413, 0.00198615, 0.11459692, 0.0327557, -0.083032,
                                  0.07179973, -0.14332476, -0.02108097, 0.03528292, 0.16648388, 0.08999237,
                                  -0.01992193, -0.19246097, -0.1850828, -0.15809669, -0.04084164, -0.06728771,
                                  0.0032042, -0.16082945, -0.28345203, -0.16457698, -0.05449484, -0.09179959,
                                  -0.1115014, 0.12535867},
                                 {0.1267404, -0.15832326, 0.06373357, -0.0275562, -0.05598782, -0.00755285,
                                  0.18958266, 0.07855778, -0.2459217, 0.19851334, 0.12364193, 0.06555974,
                                  0.07327026, 0.07117049, -0.02376478, 0.1213145, -0.00148553, 0.16215603,
                                  0.03457607, -0.20853186, -0.01900295, 0.04076293, 0.14212246, 0.01198866,
                                  -0.2593793, -0.21986781, 0.05910296, -0.15532936, 0.09365585, -0.265344,
                                  0.05719563, -0.18140508},
                                 {0.27563152, -0.20232254, 0.16345473, 0.14312704, 0.176969, -0.11543444,
                                  -0.2503293, 0.10256076, 0.08939326, 0.25002372, -0.04541733, -0.00242004,
                                  0.04870187, 0.05390758, -0.18551359, -0.02092705, -0.20933068, -0.00631864,
                                  -0.28523168, -0.11570287, 0.20666294, -0.07172373, -0.15887837, 0.12478361,
                                  0.05549561, -0.29113528, -0.00371962, -0.09308499, 0.0475351, 0.10486303,
                                  -0.13786681, -0.15059294},
                                 {0.12732556, 0.16064462, -0.117663, 0.00959849, 0.2683091, -0.01336901,
                                  -0.01735934, -0.01218504, 0.13027483, 0.07941381, 0.2157741, -0.3157751,
                                  0.05827916, -0.2548811, 0.0641718, -0.18824928, -0.30818167, 0.3320786,
                                  -0.00730365, 0.13534944, 0.05710089, -0.03523944, -0.24816824, 0.18202084,
                                  0.17768951, -0.08053045, 0.01501595, -0.20380336, 0.3502809, -0.02178054,
                                  0.01754251, -0.17681028},
                                 {0.07728033, -0.23009644, -0.1200356, -0.10426426, -0.03965538, -0.10704333,
                                  -0.12417653, 0.15037058, -0.18518278, -0.17179804, -0.15342486, -0.00728546,
                                  -0.20074493, 0.29510844, -0.22536601, 0.26791856, 0.21555111, 0.1455796,
                                  0.14447403, 0.17167175, -0.26827085, 0.18127334, 0.13290557, 0.07147514,
                                  -0.23027785, 0.17653804, 0.1253636, 0.11460373, 0.07220609, 0.07051363,
                                  0.13161848, 0.11047158},
                                 {0.05065692, -0.10514475, 0.02569524, -0.03346449, -0.09951341, 0.06880702,
                                  -0.282466, -0.12218879, -0.1954256, 0.11125057, -0.1680044, -0.01422077,
                                  -0.17599234, -0.02989241, 0.01199023, 0.1905737, -0.11279149, -0.20505773,
                                  -0.03701654, 0.08265276, 0.08746184, 0.2510495, 0.20793705, -0.03450539,
                                  0.11533125, -0.18366696, 0.1069582, -0.21627933, -0.02275437, -0.04487112,
                                  -0.16349593, -0.13095939},
                                 {0.15445901, 0.05481571, -0.05403838, 0.08512563, -0.30362126, 0.14905372,
                                  0.1887887, -0.11440551, -0.1675586, -0.20741099, -0.21224122, -0.15624648,
                                  0.17317495, 0.11606663, -0.04643843, -0.03209005, -0.00497035, 0.16129085,
                                  0.08395025, -0.11860227, -0.19376563, -0.20976458, -0.10217752, 0.1118615,
                                  0.09276067, 0.1369168, 0.13582382, -0.22393188, 0.01434899, -0.19712444,
                                  -0.19157241, -0.02823549},
                                 {-0.22712018, 0.15092415, -0.18221775, 0.0104465, -0.05129392, 0.09534985,
                                  -0.07027745, -0.17714593, -0.10236545, -0.16593014, -0.0609953, -0.03238938,
                                  -0.19730167, -0.15389314, -0.0906262, -0.11023828, -0.16862576, -0.12724745,
                                  0.132945, -0.15336488, 0.21903814, -0.18907163, -0.2417372, 0.1715566,
                                  -0.04480135, -0.1563689, 0.03890837, -0.02389057, 0.21089618, 0.02125719,
                                  -0.15784204, 0.07804431},
                                 {0.14400019, 0.16976649, 0.21109322, -0.05458992, -0.03664015, 0.21784146,
                                  0.02914986, -0.12813249, 0.16437395, -0.01504753, -0.05417055, 0.06353609,
                                  0.18157233, -0.1245964, 0.06787513, 0.21736626, -0.01399704, -0.03070532,
                                  -0.09925667, 0.26394147, -0.06040546, -0.00924526, -0.18920565, -0.23596805,
                                  0.19092496, -0.2421598, -0.13921669, -0.00943724, 0.07442823, -0.24981768,
                                  -0.09146235, 0.22220545},
                                 {0.02039547, -0.22335447, 0.0939635, 0.17479979, -0.05833307, -0.06145737,
                                  0.2188299, -0.02458168, 0.18404907, 0.01403229, 0.19576272, 0.18784769,
                                  -0.05112074, 0.08870917, -0.02258841, 0.0001123, 0.06324553, 0.24711163,
                                  0.13912879, 0.01499738, -0.09278834, -0.05822923, -0.03429238, -0.12077606,
                                  0.12298162, 0.11778142, -0.17969449, 0.02000404, -0.03102739, 0.09195936,
                                  -0.03056866, -0.19016747},
                                 {-0.0030096, -0.12894805, 0.10983621, 0.15603642, -0.13477942, 0.06721554,
                                  -0.01120307, -0.22552742, -0.19440484, 0.06520452, -0.02549164, -0.21302536,
                                  -0.2638158, -0.2635747, 0.10861248, 0.03517439, -0.05241541, -0.21766928,
                                  -0.00816952, -0.08847492, -0.2037894, 0.10162602, -0.03833354, 0.0612818,
                                  0.19321077, 0.05200846, 0.04914979, 0.0872325, 0.12377419, 0.00431744,
                                  -0.11372663, -0.24914429},
                                 {-0.23150216, 0.10054914, -0.2411793, 0.07187624, -0.05662839, 0.07243236,
                                  0.01230988, -0.2448001, -0.06918529, -0.06613183, 0.09724966, 0.08186612,
                                  -0.11426687, 0.23629771, 0.21807785, 0.02437894, 0.23547359, -0.29248565,
                                  -0.21022317, 0.05533711, -0.1733507, 0.01847878, -0.15182516, -0.03701301,
                                  -0.19944407, -0.1644639, 0.03036815, -0.06391016, -0.12883922, 0.15319236,
                                  -0.06867487, -0.09462644},
                                 {-0.20459847, 0.17561166, 0.01313057, -0.05863228, -0.08221042, -0.16746238,
                                  -0.18561754, -0.200398, -0.05993227, 0.03734196, 0.0708179, 0.10912587,
                                  0.09048489, 0.12372439, 0.07789472, 0.05495114, -0.12617278, -0.06972077,
                                  -0.08983551, -0.11299995, -0.23537658, -0.08646362, -0.11516885, -0.18216923,
                                  -0.14866564, -0.12367406, 0.18543202, 0.00947855, 0.06932063, -0.13011771,
                                  0.11546623, -0.08930121},
                                 {-0.08798549, 0.0702337, -0.09909192, -0.11221198, 0.15720497, -0.19978543,
                                  0.0411987, -0.1192017, 0.13328087, -0.1823022, 0.04274723, -0.12610863,
                                  -0.10960883, -0.16416715, -0.11184243, 0.03218985, 0.09362076, 0.19080897,
                                  -0.28878236, -0.1739359, -0.00050529, -0.10212981, -0.15780668, -0.04134078,
                                  -0.0987796, 0.03116184, 0.14310756, -0.09003448, -0.09096778, -0.03020332,
                                  -0.05795496, -0.05611552},
                                 {0.1835969, -0.23177454, 0.05329632, -0.14581661, 0.04517039, 0.02243613,
                                  -0.20822391, -0.08522234, 0.16631414, 0.07381167, -0.17205346, -0.02006931,
                                  0.07471585, -0.02412632, 0.18493101, 0.21966921, -0.20171745, -0.10258301,
                                  0.24034649, -0.22421633, 0.02542254, -0.06437627, 0.09895381, 0.11605824,
                                  0.12540057, -0.13323344, 0.14996237, -0.01294328, -0.02411737, -0.25375435,
                                  -0.1503751, 0.06113716},
                                 {0.24957387, -0.14582089, 0.15549485, 0.07583673, 0.16721569, 0.16102597,
                                  -0.11684292, 0.1510239, 0.00886271, 0.14194869, -0.12672083, -0.09429743,
                                  -0.27763104, 0.16337965, 0.08614833, -0.14437887, 0.11080885, -0.00914214,
                                  0.09973539, -0.02066513, -0.1829165, -0.2560319, -0.06042981, -0.23175977,
                                  0.19859421, -0.01165544, 0.05047436, 0.18894298, 0.11275791, -0.24384849,
                                  0.15267555, -0.07071488},
                                 {-0.22716062, -0.07541369, 0.00858154, 0.04454846, 0.2309612, -0.16805923,
                                  0.13699475, 0.18358961, -0.12805794, -0.19515945, 0.20147488, -0.01976016,
                                  0.06269686, 0.22838777, -0.22016743, -0.11082697, -0.1822717, 0.08669048,
                                  -0.07945667, 0.03007726, 0.0604592, 0.14578378, 0.13277592, 0.12793267,
                                  0.05634547, -0.11154721, 0.06237158, -0.10822888, -0.14757577, 0.14848697,
                                  -0.04877393, 0.16033351},
                                 {-0.1414865, 0.26419967, -0.23993714, -0.08825057, 0.02397628, 0.05392642,
                                  -0.09621784, -0.22007123, 0.01353309, 0.06660316, 0.16763638, -0.2928898,
                                  -0.12027697, 0.11997136, 0.07739946, -0.04768456, -0.09509856, 0.05439741,
                                  -0.05945916, -0.21539783, -0.06940933, -0.2811126, -0.04199841, -0.17873134,
                                  0.12531208, -0.25032315, -0.1718188, 0.1115796, -0.02413641, 0.12697609,
                                  -0.14769292, 0.04689904},
                                 {-0.3322948, 0.03727428, 0.25552192, -0.0021328, 0.02748204, 0.15219605,
                                  -0.10299388, 0.06010288, 0.04033598, -0.26807925, -0.28066286, -0.11624902,
                                  -0.25303662, 0.02882588, 0.06883366, 0.08143537, 0.15949921, 0.14529638,
                                  0.01604393, -0.08729117, -0.16352135, -0.00220605, -0.1338358, 0.10058656,
                                  -0.09010867, -0.25365955, -0.18085223, -0.10995297, -0.14630266, 0.1439405,
                                  -0.16455144, 0.29231045},
                                 {-0.11262162, -0.23639506, 0.10863332, -0.1212168, -0.16600677, -0.26742303,
                                  -0.27463362, -0.00517129, 0.13307291, 0.11993828, -0.25566593, 0.15394755,
                                  -0.15518273, 0.16126671, 0.17592996, -0.18239139, -0.18584192, -0.08739334,
                                  -0.22055502, 0.14851852, 0.20010951, -0.15527669, -0.07549435, 0.04414216,
                                  0.17199312, -0.13766266, 0.22658524, -0.13742268, 0.0095192, -0.09507999,
                                  -0.00084528, -0.17356709},
                                 {0.06248302, 0.07802825, -0.07460118, -0.22543433, -0.06109667, -0.04480185,
                                  0.13839628, 0.1502009, 0.23785974, -0.13160913, 0.11233521, 0.17317858,
                                  -0.10108852, -0.06468575, -0.21703325, -0.23807359, -0.19212513, 0.08717424,
                                  0.03279497, -0.10489806, 0.06035441, -0.06859094, -0.05137961, -0.18750161,
                                  0.19066316, 0.18086827, -0.1413456, 0.05663517, -0.22602521, 0.07479857,
                                  -0.14326525, 0.08277178},
                                 {0.03534084, -0.00246181, -0.03071331, -0.10936031, -0.14135998, -0.14793327,
                                  -0.1345784, 0.05245488, 0.14812438, -0.22760601, -0.27357766, -0.1835152,
                                  -0.27756923, 0.13975985, -0.15585792, -0.18840568, 0.16733935, 0.02603871,
                                  0.1560311, 0.17930545, -0.04616098, 0.08183591, -0.188102, -0.00526465,
                                  0.18666448, 0.03534978, -0.12300714, 0.05449949, -0.09575024, 0.10952187,
                                  -0.11497682, 0.04963492},
                                 {0.042742, 0.03967491, 0.10625596, -0.16649495, -0.22530437, 0.05173685,
                                  0.13283485, -0.16639428, 0.1886448, -0.16805692, -0.07659301, 0.06024861,
                                  -0.1809069, 0.00752855, -0.14367846, 0.13171482, -0.05612559, -0.0770199,
                                  -0.04146795, 0.01277553, -0.1819677, -0.1856462, 0.11363006, -0.23546082,
                                  -0.09831096, -0.12900463, 0.08242867, 0.14354922, 0.17350058, -0.14048728,
                                  -0.11571249, 0.01955472},
                                 {-0.18735708, 0.10638775, -0.1348602, 0.21366005, -0.03878675, -0.11298908,
                                  0.00678599, 0.13657895, -0.09164514, -0.09218165, 0.05813613, 0.02004875,
                                  -0.21966743, 0.14992666, -0.1679724, -0.08031791, -0.06070443, 0.1004307,
                                  0.19730522, 0.10004085, -0.10496741, -0.00185034, -0.23248537, -0.03515702,
                                  -0.16573718, -0.07975399, -0.14369705, 0.12583603, 0.02982057, -0.10856169,
                                  0.06386033, 0.01003636},
                                 {-0.17543219, -0.2419369, -0.16763884, -0.2849173, 0.03775722, 0.2322341,
                                  -0.1425483, -0.16315627, 0.05711477, -0.19312726, 0.14468147, -0.05103327,
                                  -0.03068785, 0.21271089, -0.03098533, 0.09919737, -0.1411035, -0.1387575,
                                  0.07675698, 0.01690436, -0.03246126, 0.11074214, -0.04364782, 0.12434498,
                                  -0.08833176, -0.00142132, 0.18754508, -0.06001163, 0.1049628, 0.10385022,
                                  -0.0733941, -0.06656641},
                                 {0.20541161, 0.26174977, 0.10516028, -0.18445365, 0.31680304, -0.121203,
                                  -0.15928881, -0.01056939, -0.27303287, 0.14328825, -0.06025467, -0.1591808,
                                  0.2601691, -0.36073992, 0.09275694, -0.16574863, -0.04364135, 0.09607413,
                                  0.06437077, -0.27802482, 0.02151409, -0.0831039, 0.06623857, 0.21525131,
                                  -0.06332561, -0.09907056, 0.01861689, 0.06195908, 0.17250173, -0.01656055,
                                  -0.13129659, -0.16997612},
                                 {-0.04252619, 0.11942358, -0.21614783, 0.08752108, 0.10303733, -0.15339454,
                                  -0.21814543, 0.0256669, 0.07911398, 0.06569641, 0.03295701, 0.17311084,
                                  -0.18227963, -0.28101367, 0.12694153, -0.15252379, -0.2161926, 0.14774631,
                                  0.11217778, -0.30560344, -0.165916, -0.06583339, -0.06151628, 0.22608955,
                                  0.07396864, -0.06451391, -0.00731941, -0.25004005, 0.22715133, -0.07748494,
                                  0.0655134, -0.14356305},
                                 {0.14756957, 0.00547301, -0.00910348, 0.25171897, 0.06913209, -0.16393057,
                                  -0.14381382, 0.24906395, 0.12118334, 0.12375019, -0.02102722, -0.16437094,
                                  0.14633544, 0.07072823, -0.17567828, 0.18938632, 0.23887786, -0.11434541,
                                  -0.12829234, 0.13404314, -0.17872742, -0.04296505, -0.17966883, -0.03846055,
                                  -0.19955938, -0.03299547, 0.0095126, -0.20510079, -0.2923965, -0.1241761,
                                  0.2750161, -0.09949482},
                                 {-0.00457478, -0.12493082, -0.12437749, -0.19903761, 0.2276113, -0.2257269,
                                  0.12608556, 0.14621045, -0.14417653, -0.19402109, 0.1818284, -0.19045982,
                                  -0.10178966, 0.05245561, -0.23488322, 0.07163198, -0.11321902, -0.06729395,
                                  -0.23312481, -0.23104905, 0.07188274, -0.05730406, -0.2622703, 0.10045488,
                                  0.0235012, -0.02086973, 0.06211616, -0.10355841, 0.09496076, 0.14515638,
                                  -0.22573957, -0.02328183},
                                 {-0.1130513, -0.11179683, -0.00499224, 0.1456365, 0.17876947, -0.02710682,
                                  -0.11714356, 0.19167475, 0.00485929, -0.16660118, -0.22420597, 0.16195816,
                                  -0.24950302, 0.0591496, -0.17516021, 0.11122682, -0.18110602, -0.21898353,
                                  0.12732776, -0.25701916, -0.19875905, -0.00208594, -0.07793914, -0.09275576,
                                  0.07058357, -0.28911597, -0.1560751, -0.11354204, -0.12275401, -0.26285553,
                                  0.0557285, 0.18823212},
                                 {0.03504389, 0.25898635, -0.14617373, -0.11608403, -0.12149934, 0.12583661,
                                  -0.20477581, -0.1780506, -0.20574565, 0.21562088, 0.20402552, -0.11431006,
                                  -0.21317156, -0.19031677, -0.1838028, -0.05999143, 0.16593757, 0.0656804,
                                  0.16262312, 0.06049346, 0.10771099, -0.2338321, -0.28520948, 0.03917648,
                                  0.23492791, 0.04342052, 0.06208262, -0.21520275, -0.01229518, -0.02638139,
                                  0.17858112, -0.2597617},
                                 {0.11428945, -0.22616225, -0.06941509, -0.13369113, 0.18649146, 0.153605,
                                  0.13689785, 0.11443732, 0.14665215, -0.1045695, -0.03698648, 0.23442596,
                                  0.00495112, 0.1506227, -0.24101728, -0.08966653, -0.09164873, 0.08058612,
                                  -0.01787388, -0.13716619, 0.05496241, 0.01474657, -0.17775421, -0.21932545,
                                  0.11085587, -0.04844431, 0.02600287, 0.01669629, 0.13794677, -0.09999727,
                                  -0.00695401, -0.048979},
                                 {-0.20828734, 0.08261384, 0.05521192, 0.20514676, -0.14780791, -0.14910814,
                                  0.02227703, 0.09021927, -0.13748175, 0.21607314, -0.15762931, -0.02207812,
                                  -0.27285904, -0.23728569, -0.07267722, -0.13392226, 0.09428798, 0.04711744,
                                  -0.2501369, -0.2803815, 0.06767739, 0.07472435, -0.20888154, -0.11085553,
                                  -0.04979437, 0.1084889, 0.05299433, -0.09382968, -0.1733967, 0.07515462,
                                  0.11149331, -0.0224316},
                                 {-0.01033168, 0.1157876, 0.01654665, -0.04487505, -0.1460322, 0.20390576,
                                  0.10977673, 0.11572216, -0.06506693, -0.11729692, -0.14791334, -0.22013688,
                                  -0.09878403, -0.02094685, 0.08125032, 0.15775263, 0.09048796, 0.03543369,
                                  0.16742462, 0.09194036, -0.029873, 0.21506181, 0.03306542, 0.06674206,
                                  0.0658275, -0.17000276, -0.14309907, -0.14343318, -0.07876962, 0.14559497,
                                  -0.14633301, 0.13422637},
                                 {-0.12855048, -0.24602976, 0.04689951, -0.10207348, -0.17701823, 0.1739429,
                                  -0.01761929, 0.11537358, -0.14579739, -0.2929654, -0.0738609, 0.00199782,
                                  -0.16247538, 0.09302826, 0.10375188, 0.22764419, -0.19987133, 0.03593789,
                                  0.11263063, 0.32801342, -0.11407647, -0.16499193, 0.05812143, 0.10906628,
                                  -0.11238629, 0.13638498, -0.21545559, -0.22162406, 0.05965582, -0.03846308,
                                  0.12107824, 0.1638299},
                                 {0.04295192, -0.16863309, -0.22311231, 0.09099457, 0.18708828, 0.08193586,
                                  0.02097638, 0.00992226, 0.0210709, 0.14743446, 0.11641651, -0.0436693,
                                  -0.16866027, -0.03409809, -0.21246892, -0.16335198, -0.27313653, 0.1899057,
                                  -0.15492338, -0.27082187, 0.12846452, -0.32058468, -0.01252334, 0.29324445,
                                  0.27785653, 0.21574607, -0.04112942, -0.18818462, 0.09651539, 0.24002813,
                                  -0.11557407, 0.1464723},
                                 {0.1317823, -0.10259097, 0.07061134, -0.25016603, -0.07087474, 0.17589441,
                                  0.06483153, -0.0251199, -0.04690601, -0.06056762, -0.20306042, -0.07965858,
                                  0.18153249, -0.26015443, -0.22664253, 0.21513644, 0.19590697, -0.04838926,
                                  0.02264236, -0.005165, -0.02664838, 0.08182947, 0.16452108, -0.16651312,
                                  -0.14481106, 0.1353418, -0.09128888, -0.06813514, -0.11075246, -0.20342681,
                                  0.17415981, 0.12642176},
                                 {0.03519272, -0.04760373, 0.28622338, -0.05252492, 0.1403781, 0.1745309,
                                  0.10170704, -0.23034967, -0.11214195, 0.05554401, 0.08671794, 0.04305791,
                                  0.03074263, 0.06776211, -0.2698756, 0.11567473, 0.08672129, 0.1215141,
                                  0.2097143, -0.2842259, 0.10569985, -0.1206862, -0.2139824, -0.04614628,
                                  0.17657393, -0.18933298, -0.10899022, 0.04415226, -0.21222444, 0.17116077,
                                  -0.23414159, 0.05227132},
                                 {0.18532598, -0.02342837, -0.15858753, -0.20571919, -0.18635134, -0.03265347,
                                  0.01566658, -0.26112577, -0.19312565, 0.05635779, -0.20200595, 0.20120294,
                                  0.03212976, -0.12396919, -0.24565493, 0.19749509, -0.27510357, 0.02270876,
                                  0.01249596, -0.14666024, -0.20140591, -0.02123738, 0.08962583, 0.12913916,
                                  -0.17527625, 0.00164052, 0.20964314, 0.17412198, -0.16751139, -0.23285599,
                                  -0.15953872, 0.1657812},
                                 {0.13946302, -0.02265576, -0.00124959, -0.2127196, 0.04305422, -0.0621242,
                                  -0.2100196, 0.02823902, -0.12786677, 0.10223105, 0.21482053, -0.14590809,
                                  0.18261422, -0.13491969, -0.04934125, 0.00440533, 0.15842032, 0.0184779,
                                  0.0092527, 0.05775262, 0.20628649, -0.09939692, 0.02401479, 0.00949104,
                                  0.14663771, -0.23507595, -0.11509187, 0.07407179, 0.0982781, 0.1661901,
                                  0.0250761, -0.06402653},
                                 {0.15736058, -0.25532413, 0.09480417, -0.06140081, -0.3256767, -0.06954996,
                                  -0.15323593, 0.17694004, -0.02755767, -0.3017506, -0.02311022, 0.20611493,
                                  0.05444201, -0.08733026, 0.09973908, 0.19602646, -0.04450213, -0.04140586,
                                  0.25898674, -0.00261687, -0.25089177, -0.00225495, 0.01027359, -0.17026892,
                                  -0.20280127, 0.03091303, -0.14978334, 0.09676202, 0.12349755, 0.00423768,
                                  -0.19967054, 0.126096},
                                 {-0.15165624, -0.1934833, -0.27267864, -0.16080414, -0.12005062, -0.2560111,
                                  -0.06800398, 0.04079961, 0.02166317, 0.04434586, -0.12040905, -0.30391854,
                                  -0.11150716, 0.00050565, 0.06294702, 0.13203542, -0.06132812, 0.19724041,
                                  -0.00787303, 0.14494053, 0.16633856, -0.15876514, 0.17358124, -0.20439357,
                                  -0.07189924, -0.14034104, 0.18599187, 0.17551935, -0.20799392, 0.14511445,
                                  0.21492007, -0.13182656},
                                 {0.0303927, 0.13726905, -0.10564928, -0.04094212, 0.0686138, 0.18946134,
                                  -0.01568214, -0.08516655, 0.2100915, -0.0543735, 0.11315425, -0.11666221,
                                  -0.16821584, 0.09664111, 0.05264651, 0.07372318, 0.23406243, -0.07055164,
                                  -0.19446033, 0.13902313, -0.00052918, 0.15078962, 0.13666822, -0.2696664,
                                  0.01510134, -0.04977288, -0.24316639, 0.16989084, -0.05710829, 0.18349615,
                                  -0.16952167, 0.20660779},
                                 {0.29551664, 0.04180734, -0.26944512, 0.1671327, -0.00602452, 0.05549191,
                                  0.00899131, -0.24479878, -0.18652782, -0.07103498, 0.0428975, -0.22040838,
                                  0.26177603, 0.02500436, 0.14899157, 0.10393265, -0.07814773, -0.05126027,
                                  0.13730498, -0.2038933, 0.03187954, 0.10475472, -0.12333506, 0.20000754,
                                  0.09223758, 0.18796214, -0.1674826, 0.12577523, -0.01595078, 0.25707832,
                                  -0.30151832, -0.18142004},
                                 {-0.1820232, -0.14251731, 0.2184296, -0.17299646, -0.03450285, 0.07370906,
                                  -0.10282551, 0.17071949, 0.10078575, -0.27648124, 0.00900409, 0.16564035,
                                  -0.3117515, 0.1617722, -0.09795889, -0.02644706, 0.22635102, -0.26207653,
                                  -0.01830809, -0.01553444, 0.10752776, -0.1241397, 0.16359566, 0.11430501,
                                  -0.26394477, 0.02135381, 0.18144777, 0.23184024, -0.13269085, -0.29363465,
                                  -0.13089728, -0.0471334},
                                 {-0.07620241, 0.16452818, -0.23631221, -0.06077861, -0.05180988, 0.17042634,
                                  0.02261812, 0.10831145, 0.21248828, 0.13487643, -0.16545257, -0.04289586,
                                  -0.08399209, -0.25947353, 0.00332961, -0.17142178, 0.18139406, 0.16636452,
                                  -0.2393258, 0.23001121, -0.006951, -0.08824972, -0.22058083, 0.11924772,
                                  -0.00824958, -0.06122486, 0.06572501, 0.17661956, -0.12275825, 0.19105093,
                                  -0.21640395, 0.02184846},
                                 {-0.12794745, 0.09061741, 0.00500112, 0.11211675, 0.11594702, -0.22776356,
                                  -0.10425332, -0.2097347, 0.1276018, -0.20117694, 0.02443168, 0.28977954,
                                  -0.10316741, 0.30309033, -0.18073043, 0.12557314, 0.09159403, -0.09944029,
                                  0.17568922, 0.26243946, -0.17530781, 0.13779755, -0.10062169, -0.28553683,
                                  -0.02165694, 0.01540542, 0.02773965, 0.03373819, -0.25040108, 0.00632906,
                                  0.22307421, -0.19510649},
                                 {0.1438227, -0.05524094, 0.26152045, -0.15193535, -0.10377044, -0.13010675,
                                  0.01694241, 0.01018096, 0.00220874, 0.06857096, 0.16903697, 0.07113326,
                                  0.08898129, 0.21825449, -0.19040388, 0.17964457, 0.02686558, 0.17403865,
                                  -0.0087133, -0.13949633, -0.1637169, -0.03780111, 0.1657962, 0.17036662,
                                  -0.04964018, 0.02049311, 0.15585521, 0.16000515, -0.05013523, 0.20117679,
                                  0.11086086, 0.1112107},
                                 {0.06849156, 0.22203916, 0.03088458, -0.05639167, -0.00833748, 0.12750752,
                                  0.08252367, 0.1694435, 0.09074069, -0.20835775, -0.00284241, 0.09461182,
                                  -0.20063992, -0.24704523, 0.19916415, -0.02641254, 0.01719904, -0.17652482,
                                  -0.1158758, 0.01076864, -0.1216198, -0.04968533, -0.07036813, 0.08158388,
                                  -0.06603413, 0.06046344, -0.2117442, -0.02732988, -0.0816344, -0.06273697,
                                  0.18152922, 0.13898784}};

double biases_layer2[32] = {0.00774566,
                            0.01708526,
                            0.00894008,
                            -0.02652969,
                            0.03705827,
                            -0.03053606,
                            -0.07049594,
                            0.00600159,
                            -0.04767491,
                            -0.0234969,
                            -0.02539633,
                            0.00491358,
                            -0.03740454,
                            0.03431822,
                            -0.0877848,
                            0.03744658,
                            -0.02886295,
                            0.02365504,
                            -0.00384568,
                            0.08764201,
                            0.05174642,
                            -0.01157429,
                            -0.01384778,
                            -0.02304233,
                            0.02935174,
                            -0.0667517,
                            -0.05147251,
                            -0.02496205,
                            0.01704805,
                            -0.08044319,
                            0.00548389,
                            -0.05837961};

double weights_output[32][1] = {{0.20564389},
                                {0.11443933},
                                {-0.31668812},
                                {-0.15223666},
                                {0.2301181},
                                {-0.07796703},
                                {0.25303182},
                                {-0.13877776},
                                {-0.20779966},
                                {0.17075558},
                                {0.30717525},
                                {-0.12930752},
                                {0.10327905},
                                {-0.09527755},
                                {0.3010156},
                                {-0.06587382},
                                {-0.24327841},
                                {0.08454978},
                                {-0.14158401},
                                {-0.08005415},
                                {0.23048133},
                                {-0.31536934},
                                {-0.01898452},
                                {0.23527062},
                                {0.21779165},
                                {0.19995664},
                                {0.1006595},
                                {0.27926227},
                                {0.04631312},
                                {0.29845998},
                                {-0.26134965},
                                {-0.3265562}};

double bias_output[1] = {-0.0012292};
struct features
{
    /* data */
    double hr;
    double ref_find;
    double sys_time;
    double foot_time;
    double lasi;
    double crest_time;
    double mnpv;
    double pir;
    double aix;
    double pulse_height;
    double pulse_width;
    double hrv;
    double amplitude_ratios;
    double max_amplitude;
    double min_amplitude;
    double womersley_number;
    double alpha;
    double ipa;
    double pwv;
    double sys_time_x;
};
static void filter(const double b[5], const double a[5], const double x[174], const double zi[4], double y[174]);
static void filtfilt(const double x_in[150], double y_out[150]);
void print_new_lines()
{
    nl;
    nl;
    nl;
    nl;
}

static void filter(const double b[5], const double a[5], const double x[174], const double zi[4], double y[174])
{
    int k;
    int naxpy;
    int j;
    double as;
    for (k = 0; k < 4; k++)
    {
        y[k] = zi[k];
    }

    memset(&y[4], 0, 170U * sizeof(double));
    for (k = 0; k < 174; k++)
    {
        naxpy = 174 - k;
        if (!(naxpy < 5))
        {
            naxpy = 5;
        }

        for (j = 0; j + 1 <= naxpy; j++)
        {
            y[k + j] += x[k] * b[j];
        }

        naxpy = 173 - k;
        if (!(naxpy < 4))
        {
            naxpy = 4;
        }

        as = -y[k];
        for (j = 1; j <= naxpy; j++)
        {
            y[k + j] += as * a[j];
        }
    }
}

static void filtfilt(const double x_in[150], double y_out[150])
{
    double xtmp;
    double d1;
    int i;
    double y[174];
    double b_y[174];
    double a[4];
    static const double b_a[4] = {-0.19377359529033994, -0.1937735952902776,
                                  0.19377359529029725, 0.19377359529031876};

    static const double dv1[5] = {0.19377359529031332, 0.0, -0.38754719058062664,
                                  0.0, 0.19377359529031332};

    static const double dv2[5] = {1.0, -2.342095632660552, 1.9477115412319015,
                                  -0.80784671655553675, 0.20433295072565855};

    xtmp = 2.0 * x_in[0];
    d1 = 2.0 * x_in[149];
    for (i = 0; i < 12; i++)
    {
        y[i] = xtmp - x_in[12 - i];
    }

    memcpy(&y[12], &x_in[0], 150U * sizeof(double));
    for (i = 0; i < 12; i++)
    {
        y[i + 162] = d1 - x_in[148 - i];
    }

    for (i = 0; i < 4; i++)
    {
        a[i] = b_a[i] * y[0];
    }

    memcpy(&b_y[0], &y[0], 174U * sizeof(double));
    filter(dv1, dv2, b_y, a, y);
    for (i = 0; i < 87; i++)
    {
        xtmp = y[i];
        y[i] = y[173 - i];
        y[173 - i] = xtmp;
    }

    for (i = 0; i < 4; i++)
    {
        a[i] = b_a[i] * y[0];
    }

    memcpy(&b_y[0], &y[0], 174U * sizeof(double));
    filter(dv1, dv2, b_y, a, y);
    for (i = 0; i < 87; i++)
    {
        xtmp = y[i];
        y[i] = y[173 - i];
        y[173 - i] = xtmp;
    }

    memcpy(&y_out[0], &y[12], 150U * sizeof(double));
}

int find_signal_peaks(double signal[], int signal_len, int peaks[], int is_ecg, int to_print)
{

    double ecg_mean = 0;
    int div = 0;
    int store[MAX_PEAKS];
    int store_index = 0;
    int num_peaks = 0, amplitude_tolerance = 5, peak_distance = 10;
    if (is_ecg)
    {
        if (to_print)
        {
            printf("ecg printing\n");
            for (int i = 0; i < signal_len; i++)
            {
                printf("%f,", signal[i]);
            }
            print_new_lines();
        }
        for (int i = 0; i < signal_len; i++)
        {
            if (signal[i] >= 1)
            {
                ecg_mean += signal[i];
                div++;
            }
        }

        ecg_mean /= div;
        // printf("ecg mean: %f\n", ecg_mean);
        // int window_size = 40;
        int window_size = 45, skip_right = 6, end_tol = 15;
        for (int i = 0; i < signal_len;)
        {
            int start = i, end = i + window_size;

            if (start >= signal_len || end >= signal_len)
            {
                break;
            }
            int max_index = -1;
            double max_val = -1.0;
            for (int j = start; j < end; j++)
            {
                if (signal[j] > max_val)
                {
                    max_val = signal[j];
                    max_index = j;
                }
            }
            if (max_index != -1)
            {

                int q_peak = max_index;
                while (q_peak > start && signal[q_peak] > signal[q_peak - 1])
                {
                    q_peak--;
                }
                int s_peak = max_index;
                // this will find the s peak
                while (s_peak + 1 < end + end_tol && signal[s_peak] > signal[s_peak + 1])
                {
                    s_peak++;
                }
                double r_to_q = (signal[max_index] - signal[q_peak]);
                double r_to_s = (signal[max_index] - signal[s_peak]);

                if (max_index >= 1 && max_index + 1 < signal_len && signal[max_index - 1] < signal[max_index] && signal[max_index] > signal[max_index + 1] && r_to_q >= 40 && r_to_s >= 45)
                {
                    store[store_index++] = max_index; // rpeak here
                }

                // printf("qpeak: %f, rpeak: %f, speak: %f\n", signal[q_peak], signal[max_index], signal[s_peak]);
                i = s_peak + skip_right;
            }
            else
            {
                i++;
            }

            // peaks[num_peaks++] = max_index;
        }

        peaks[num_peaks++] = store[0];
        for (int i = 1; i < store_index; i++)
        {
            if (store[i] - peaks[num_peaks - 1] >= 20)
            {
                int pp = store[i];
                while (pp + 1 < signal_len && signal[pp] <= signal[pp + 1])
                {
                    pp++;
                }
                peaks[num_peaks++] = pp;
            }
        }
        if (num_peaks < 2)
        {
            int win = 10;
            for (int i = 0; i < signal_len; i += win)
            {
                int start = i, end = i + win;

                if (start >= signal_len || end >= signal_len)
                {
                    break;
                }
                int max_index = -1;
                double max_val = -1.0;
                for (int j = start; j < end; j++)
                {
                    if (signal[j] > max_val)
                    {
                        max_val = signal[j];
                        max_index = j;
                    }
                }
                peaks[num_peaks++] = max_index;
            }
        }
    }
    else
    {
        for (int i = 0; i < signal_len; i++)
        {
            int peak_index = i;
            while (peak_index + 1 < signal_len && signal[peak_index] >= signal[peak_index + 1])
            {
                peak_index++;
            }
            int left = 4, right = 6;
            // printf("peak diff: %d\n", peak_index - i);
            if (peak_index - left >= 0 && signal[peak_index - left] > signal[peak_index] && peak_index + right < signal_len && signal[peak_index] > signal[peak_index + right])
            {
                peak_index += right;
                while (peak_index + 1 < signal_len && signal[peak_index] >= signal[peak_index + 1])
                {
                    peak_index++;
                }
            }

            // valid foot checking
            if (signal[peak_index - left] > signal[peak_index] && signal[peak_index] < signal[peak_index + left])
            {

                while (peak_index >= 1 && signal[peak_index] >= signal[peak_index - 1])
                {
                    peak_index--;
                }
                store[store_index++] = peak_index; // foot here
                peaks[num_peaks++] = peak_index;
            }
            else
            {
                peak_index = i + 2;
                continue;
            }

            while (peak_index + 1 < signal_len && signal[peak_index] <= signal[peak_index + 1])
            {
                peak_index++;
            }
            i = peak_index;
        }
    }
    return num_peaks;
}

int ampd(double *ppg_filt, int n, int final_peaks[], int is_ecg)
{

    int max_len = 0;
    int global_peaks[MAX_PEAKS] = {0};
    int global_peaks_len = 0;

    for (int window_len = 3; window_len < n - 3; window_len++)
    {
        int store[MAX_PEAKS];
        int store_len = 0;

        for (int low = 0; low + window_len < n; low++)
        {
            int max_index = low;
            double max_ppg_val = ppg_filt[low];

            for (int j = low; j < low + window_len; j++)
            {
                if (ppg_filt[j] >= max_ppg_val)
                {
                    max_ppg_val = ppg_filt[j];
                    max_index = j;
                }
            }

            if (max_index >= 1 && max_index + 1 < n && ppg_filt[max_index] > ppg_filt[max_index - 1] && ppg_filt[max_index] > ppg_filt[max_index + 1])
            {
                int duplicate = 0;
                for (int k = 0; k < store_len; k++)
                {
                    if (store[k] == max_index)
                    {
                        duplicate = 1;
                        break;
                    }
                }

                if (!duplicate)
                {
                    store[store_len] = max_index;
                    store_len++;
                }
            }
        }

        if (store_len > max_len)
        {
            max_len = store_len;
            global_peaks_len = store_len;
            for (int i = 0; i < store_len; i++)
            {
                global_peaks[i] = store[i];
            }
        }
    }

    int improved_peaks[MAX_PEAKS] = {0};
    int improved_peaks_len = 0, amplitude_tolerance = 6;

    if (is_ecg)
    {
        amplitude_tolerance = 24;
    }

    for (int i = 0; i < global_peaks_len; i++)
    {
        int peak = global_peaks[i];
        while (peak + 1 < n && ppg_filt[peak] < ppg_filt[peak + 1])
        {
            peak++;
        }
        improved_peaks[improved_peaks_len++] = peak;
    }

    int final_peaks_len = 0, tol = 15;
    final_peaks[final_peaks_len++] = improved_peaks[0];

    for (int i = 1; i < improved_peaks_len; i++)
    {
        if (improved_peaks[i] - final_peaks[final_peaks_len - 1] >= tol)
        {
            final_peaks[final_peaks_len++] = improved_peaks[i];
        }
    }
    if (is_ecg)
    {
        for (int i = 0; i < final_peaks_len; i++)
        {
            printf("peak: %d, value %f\n", final_peaks[i], ppg_filt[final_peaks[i]]);
        }
    }

    return final_peaks_len;
}

void print_peaks(int peaks_array[], int n)
{
    printf("printing peaks\n");
    for (int i = 0; i < n; i++)
    {
        printf("%d,", peaks_array[i]);
    }
    nl;
    nl;
    nl;
    nl;
}

void print_signal(double signal_array[], int n)
{
    printf("printing signal\n");
    for (int i = 0; i < n; i++)
    {
        printf("%f,", signal_array[i]);
    }
    nl;
    nl;
    nl;
    nl;
}

void calculate_derivative(const double signal[], double derivative[], int length)
{
    for (int i = 1; i < length; i++)
    {
        derivative[i - 1] = signal[i] - signal[i - 1];
    }
}

double find_ptt(double ppg_signal_1[], double ppg_signal_2[], int n, int *peak1, int *peak2, int *num_peaks)
{
    // double fs = 200.0;
    double fs = (double)n / 30;
    printf("Sampling frequency: %f\n", fs);

    double diff_ppg_signal_1[n - 1];
    double diff_ppg_signal_2[n - 1];
    calculate_derivative(ppg_signal_1, diff_ppg_signal_1, n);
    calculate_derivative(ppg_signal_2, diff_ppg_signal_2, n);

    int final_peaks1[MAX_PEAKS] = {0};
    int final_peaks2[MAX_PEAKS] = {0};
    int final_peaks_len1 = ampd(diff_ppg_signal_1, n - 1, final_peaks1, 0);
    int final_peaks_len2 = ampd(diff_ppg_signal_2, n - 1, final_peaks2, 0);

    // Determine the minimum length for peak matching
    int min_length = (final_peaks_len1 < final_peaks_len2) ? final_peaks_len1 : final_peaks_len2;
    double average_ptt = 0.0;
    int peak_count = 0;

    int keep1[n - 1];
    int keep2[n - 1];
    for (int i = 0; i < n - 1; i++)
    {
        keep1[i] = 0;
        keep2[i] = 0;
    }
    for (int i = 0; i < final_peaks_len1; i++)
    {
        if (final_peaks1[i] != -1)
        {
            keep1[final_peaks1[i]]++;
        }
    }

    for (int i = 0; i < final_peaks_len2; i++)
    {
        if (final_peaks2[i] != -1)
        {
            keep2[final_peaks2[i]]++;
        }
    }

    int start = 0, end = n - 2, tol = 5;

    for (int i = tol; i < n - 1; i++)
    {
        if (keep1[i] && keep2[i])
        {
            start = i;
            break;
        }
    }

    for (int i = start; i < n - 1; i++)
    {
        if (keep1[i] && keep2[i] && i < min_length - tol)
        {
            end = i;
        }
    }
    printf("start: %d, end: %d\n", start, end);
    int right_shift_tol = 0;

    for (int i = 0; i < min_length; i++)
    {
        int peak1_val = final_peaks1[i], peak2_val = final_peaks2[i];

        if (peak2_val != -1)
        {
            peak2_val += right_shift_tol;
        }

        if (peak1_val != -1 && peak2_val != -1 && peak1_val != peak2_val)
        {
            peak1[peak_count] = peak1_val;
            peak2[peak_count] = peak2_val - right_shift_tol;

            double peak_diff = fabs((double)(peak1_val - peak2_val)) / fs;
            // printf("peak1 = %d, peak2 = %d, peak_diff = %f\n", peak1_val, peak2_val, peak_diff);
            average_ptt += peak_diff;
            peak_count++;
        }
    }

    if (peak_count > 0)
    {
        average_ptt /= peak_count;
        printf("PTT from C: %f\n", average_ptt);
        *num_peaks = peak_count;
        return average_ptt;
    }
    else
    {
        *num_peaks = 0;
        return -1;
    }
}

void filter_here(double signal[], int signal_len, double mother_signal[], int is_ecg)
{
    int mother_index = 0;
    for (int i = 0; i < signal_len; i += 150)
    {
        int start = i, end = i + 150;
        if (end > signal_len)
        {
            continue;
        }
        // printf("is_ecg: %d, start: %d, end: %d\n", is_ecg, i, i + 150);

        double temp_signal[150];
        int idx = 0;
        for (int j = start; j < end; j++)
        {
            temp_signal[idx] = 0.0;
            temp_signal[idx++] = signal[j];
        }

        double filtered_signal[150];
        filtfilt(temp_signal, filtered_signal);
        for (int k = 0; k < 150; k++)
        {
            mother_signal[mother_index++] = filtered_signal[k];
        }
    }
}

int max_peak(int a, int b)
{
    return a > b ? a : b;
}
int min_peak(int a, int b)
{
    return a < b ? a : b;
}
double find_heart_rate(int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double peak_intervals[num_peaks - 1];
    for (int i = 1; i < num_peaks; i++)
    {
        peak_intervals[i - 1] = (double)(sys_peaks[i] - sys_peaks[i - 1]) / fs;
    }

    double heart_rates[num_peaks - 1];
    for (int i = 0; i < num_peaks - 1; i++)
    {
        heart_rates[i] = 60.0 / peak_intervals[i];
    }

    double sum = 0.0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        sum += heart_rates[i];
    }
    double average_heart_rate = sum / (num_peaks - 1);

    return average_heart_rate;
}
double find_refliction_index(double *ppg_bwr, int n, int *sys_peaks, int num_peaks)
{
    int inflection_peak[num_peaks];
    int inflection_count = 0;
    int tol = 1;

    for (int i = 0; i < num_peaks; i++)
    {
        int peak = sys_peaks[i];
        int idx = peak;

        while (idx + 1 < n && ppg_bwr[idx] >= ppg_bwr[idx + 1])
        {
            idx++;
        }
        // printf("before: %d, after: %d\n",sys_peaks[i],idx);
        if (idx != peak && abs(idx - peak) >= tol)
        {
            inflection_peak[inflection_count++] = idx;
        }
    }
    double numerator = 0.0;
    double denominator = 0.0;

    for (int i = 0; i < inflection_count; i++)
    {
        numerator += ppg_bwr[inflection_peak[i]];
        denominator += ppg_bwr[sys_peaks[i]];
    }

    double refliction_index = numerator / denominator;
    // printf("func end\n");
    return refliction_index;
}
double trapezoidal_area(double *ppg, int n, int start_index, int end_index, double sampling_interval)
{
    double area = 0.0, div = 2 * sampling_interval;
    for (int i = start_index; i < end_index; i++)
    {
        double a = ppg[i] < 0 ? -ppg[i] : ppg[i];
        double b = ppg[i + 1] < 0 ? -ppg[i + 1] : ppg[i + 1];
        // area += ((ppg[i] + ppg[i + 1]) / div);
        area += ((a + b) / div);
    }
    return area;
}

double find_lasi(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    // ic(sys_peaks,num_peaks);
    // ic(foot,num_peaks);

    int n = 150;
    int s3[num_peaks];
    int s3_idx = 0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        s3[s3_idx++] = (int)(sys_peaks[i] + foot[i + 1]) / 2;
    }

    // ic(s3,num_peaks-1);

    double s2[num_peaks];
    for (int i = 0; i < num_peaks; i++)
    {
        s2[i] = sys_peaks[i];
    }
    double sampling_interval = 1 / fs, area = 0.0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        int s2_index = s2[i];
        int s3_index = s3[i];
        area += trapezoidal_area(ppg, n, min(s2_index, s3_index), max(s2_index, s3_index), sampling_interval);
    }
    area /= num_peaks;
    return area;
}
double find_crest_time(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double crest_time = 0;
    int div = 0;
    for (int i = 0; i < num_peaks; i++)
    {
        div++;
        crest_time += ((sys_peaks[i] - foot[i]) / fs);
    }
    crest_time /= div;
    return crest_time;
}
double find_mnpv(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{
    // sys_peaks, _ = find_peaks(ppg_signal, prominence=0.3, distance=15)
    double iac = 0;
    int div = 0;
    for (int i = 1; i < num_peaks; i++)
    {
        iac += (ppg[i] - ppg[i - 1]) / fs;
        div++;
    }
    iac /= div;
    double peak_intervals[num_peaks - 1];
    for (int i = 1; i < num_peaks; i++)
    {
        peak_intervals[i - 1] = (double)(sys_peaks[i] - sys_peaks[i - 1]) / fs;
    }
    double sum_intervals = 0.0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        sum_intervals += peak_intervals[i];
    }

    double average_interval = sum_intervals / (num_peaks - 1);

    double result = iac / (iac + average_interval);
    return result;
}
double find_foot_time(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double foot_time = 0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        foot_time += ((foot[i + 1] - sys_peaks[i]) / fs);
    }
    foot_time /= (num_peaks - 1);
    return foot_time;
}
double find_sys_time(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double foot_time = 0;
    for (int i = 0; i < num_peaks; i++)
    {
        foot_time += (sys_peaks[i] - foot[i]) / fs;
    }
    foot_time /= num_peaks;
    return foot_time;
}
double find_pir(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    // ic(sys_peaks,num_peaks);
    // ic(foot,num_peaks);

    double new_ppg[150];
    for (int i = 0; i < 150; i++)
    {
        new_ppg[i] = ppg[i];
    }

    double pir = 0;
    for (int i = 0; i < num_peaks; i++)
    {
        pir += (new_ppg[sys_peaks[i]] / new_ppg[foot[i]]);
    }
    pir /= num_peaks;
    pir -= 3.0;
    return pir;
}

double find_max_amplitude(double *ppg, int ppg_len, int foot[])
{
    double max_ppg_val = ppg[0];
    for (int i = 1; i < ppg_len; i++)
    {
        if (ppg[i] > max_ppg_val)
        {
            max_ppg_val = ppg[i];
        }
    }
    return max_ppg_val;
}

double find_min_amplitude(double *ppg, int ppg_len, int foot[])
{
    double min_ppg_val = ppg[0];
    for (int i = 1; i < ppg_len; i++)
    {
        if (ppg[i] < min_ppg_val)
        {
            min_ppg_val = ppg[i];
        }
    }
    return min_ppg_val;
}

void print_sys_peaks(int sys_peaks[], int num_peaks)
{
    printf("printing sytolic peaks: ");
    for (int i = 0; i < num_peaks; i++)
    {
        printf("%d,", sys_peaks[i]);
    }
    printf("\n");
}

double find_augmentation_index(double *ppg, int ppg_len, int sys_peaks[], int num_peaks, int foot[])
{
    // print_sys_peaks(sys_peaks,num_peaks);
    double primary_peak = ppg[sys_peaks[0]];
    double reflected_peak = ppg[sys_peaks[1]];
    double augmentation_pressure = reflected_peak - primary_peak;
    // double max_ppg_val = find_max_amplitude(ppg, ppg_len), min_ppg_val = find_min_amplitude(ppg, ppg_len);

    double max_ppg_val = ppg[0], min_ppg_val = ppg[0];

    for (int i = 1; i < ppg_len; i++)
    {
        if (ppg[i] > max_ppg_val)
        {
            max_ppg_val = ppg[i];
        }
    }

    for (int i = 1; i < ppg_len; i++)
    {
        if (ppg[i] < min_ppg_val)
        {
            min_ppg_val = ppg[i];
        }
    }

    double pulse_pressure = max_ppg_val - min_ppg_val;
    double aix = augmentation_pressure / pulse_pressure;
    return aix;
}

double find_pulse_height(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double pulse_height = 0;
    for (int i = 0; i < num_peaks; i++)
    {
        pulse_height += (ppg[sys_peaks[i]] - ppg[foot[i]]);
    }
    pulse_height /= num_peaks;
    return pulse_height;
}
double find_pulse_width(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double pulse_width = 0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        pulse_width += ((foot[i] - foot[i + 1]) / fs);
    }
    pulse_width /= (num_peaks - 1);
    return pulse_width;
}

double find_hrv(double *ppg, int sys_peaks[], int num_peaks, int foot[])
{
    double ppi[num_peaks - 1];
    for (int i = 1; i < num_peaks; i++)
    {
        ppi[i - 1] = ppg[sys_peaks[i]] - ppg[sys_peaks[i - 1]];
        // printf("%f,", ppi[i - 1]);
    }
    // nl;
    double mean = 0.0, sum_deviation = 0.0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        mean += ppi[i];
    }
    mean /= (num_peaks - 1);
    for (int i = 0; i < num_peaks - 1; i++)
    {
        sum_deviation += (ppi[i] - mean) * (ppi[i] - mean);
    }
    double div = sum_deviation / (num_peaks - 1);
    double hrv = sqrt(div);
    return hrv > 1 ? 1 - hrv : hrv;
}
double find_amplitude_ratios(double *ppg, int sys_peaks[], int num_peaks, int foot[])
{
    double sys_peaks_amplitudes[num_peaks];
    double shifted_sys_peaks_amplitudes[num_peaks];

    for (int i = 0; i < num_peaks; i++)
    {
        sys_peaks_amplitudes[i] = ppg[sys_peaks[i]];
        shifted_sys_peaks_amplitudes[i] = ppg[sys_peaks[i]];
    }
    double tmp = shifted_sys_peaks_amplitudes[num_peaks - 1];
    for (int i = num_peaks - 1; i > 0; i--)
    {
        shifted_sys_peaks_amplitudes[i] = shifted_sys_peaks_amplitudes[i - 1];
    }
    shifted_sys_peaks_amplitudes[0] = tmp;
    double amplitude_ratios[num_peaks];
    for (int i = 0; i < num_peaks; i++)
    {
        amplitude_ratios[i] = sys_peaks_amplitudes[i] / shifted_sys_peaks_amplitudes[i];
    }
    double mean_amplitude_ratios = 0.0;
    for (int i = 1; i < num_peaks; i++)
    {
        mean_amplitude_ratios += amplitude_ratios[i];
    }
    mean_amplitude_ratios /= (num_peaks - 1);
    return mean_amplitude_ratios;
}
double find_womersley_number(double *ppg, int sys_peaks[], int num_peaks, int foot[])
{

    double mean = 0.0;
    for (int i = 0; i < num_peaks; i++)
    {
        mean += ppg[foot[i]];
    }
    mean /= num_peaks;
    return mean;
}

double find_alpha(double *ppg, int sys_peaks[], int num_peaks, int foot[])
{
    // print_peaks(sys_peaks,num_peaks);
    // print_peaks(foot,num_peaks);

    double alpha = 0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        alpha += (sys_peaks[i] - foot[i] - foot[i + 1]);
    }
    alpha /= num_peaks;
    return alpha;
}

double find_ipa(double *ppg, int ppg_len, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    int s1[num_peaks];
    for (int i = 0; i < num_peaks; i++)
    {
        s1[i] = (sys_peaks[i] + foot[i]) / 2;
    }

    int s3[num_peaks - 1];
    for (int i = 0; i < num_peaks - 1; i++)
    {
        s3[i] = (sys_peaks[i] + foot[i + 1]) / 2;
    }

    int s4[num_peaks - 1];
    for (int i = 1; i < num_peaks; i++)
    {
        s4[i - 1] = foot[i];
    }

    int s2[num_peaks];
    for (int i = 0; i < num_peaks; i++)
    {
        s2[i] = sys_peaks[i];
    }

    double sampling_interval = 1 / fs;
    double area = 0.0, total = 0.0;
    for (int i = 0; i < num_peaks - 1; i++)
    {
        int s1_index = s1[i];
        int s2_index = s2[i];
        int s3_index = s3[i];
        int s4_index = s4[i];

        double area1 = trapezoidal_area(ppg, ppg_len, min(s1_index, s2_index), max(s1_index, s2_index), sampling_interval);
        double area2 = trapezoidal_area(ppg, ppg_len, min(s3_index, s4_index), max(s3_index, s4_index), sampling_interval);
        double ipa_ratio = (area2 != 0) ? (area1 / area2) : 0;

        if (ipa_ratio)
        {
            area += ipa_ratio;
            total++;
        }
    }

    // return area == 0 ? -1 : area;
    return area < 1 ? area - 1 : area;
}
double find_pwv(double *ppg, int sys_peaks[], int num_peaks, double fs, int foot[])
{

    double time_add = 0.0;
    for (int i = 0; i < num_peaks; i++)
    {
        time_add += ((sys_peaks[i] - foot[i]) / fs);
    }
    double pwv = 1 / time_add;
    return pwv < 0 ? -pwv : pwv;
}
double find_systolic_time_x(double *ppg, int sys_peaks[], int num_peaks, double fs)
{

    int n = 150;
    // for (int i = 0; i < n / 2; i++)
    // {
    //   double temp = ppg[i];
    //   ppg[i] = ppg[n - 1 - i];
    //   ppg[n - 1 - i] = temp;
    // }

    int val = 35;
    double mul_fact = (double)val / 100.0;

    int foot[50];
    double sys_time = 0.0;
    int div = 0;
    for (int i = 0; i < num_peaks; i++)
    {
        int peak = sys_peaks[i];
        int idx = peak;

        while (idx >= 1 && ppg[idx] >= ppg[idx - 1])
        {
            idx--;
        }

        int add = idx + ceil(mul_fact * abs(peak - idx));

        foot[i] = add;
        if (peak != add)
        {
            div++;
            sys_time += ((ppg[peak] - ppg[add]) / fs);
        }
    }

    sys_time /= div;
    // printf("Systolic time: %f\n", sys_time);

    return sys_time;
}
void find_systolic_peaks(double ppg_signal[150], int sys_peaks[], int *num_peaks, double filtered_ppg[150])
{
    double dv0[150];
    filtfilt(ppg_signal, dv0);
    for (int i = 0; i < 150; i++)
    {
        filtered_ppg[i] = dv0[i];
        // printf("%f,", filtered_ppg[i]);
    }
    // nl;

    int tol = 1, ppg_len = 150;
    for (int index = 0; index < ppg_len;)
    {
        int idx = index;
        while (idx + 1 < ppg_len && filtered_ppg[idx] >= filtered_ppg[idx + 1])
        {
            idx++;
        }
        if (idx >= ppg_len - 1)
        {
            break;
        }
        while (idx + 1 < ppg_len && filtered_ppg[idx] <= filtered_ppg[idx + 1])
        {
            idx++;
        }
        if (idx != index)
        {
            sys_peaks[(*num_peaks)++] = idx;
            index = idx;
        }
        else
        {
            index++;
        }
    }
}

void extract_features(double ppg[], double fs, int ppg_len, struct features *my_features)
{

    // double ppg[150] = {117,117,117,117,120,120,121,123,124,126,127,128,130,131,134,135,137,140,141,144,145,142,121,119,120,120,120,121,123,123,124,126,127,128,130,131,134,135,137,138,141,141,124,121,123,121,121,123,124,126,126,127,130,131,133,134,135,138,141,144,145,148,151,140,121,120,121,119,119,121,123,123,124,126,128,130,131,133,134,137,140,141,142,147,148,127,120,120,121,119,120,123,124,124,126,128,130,131,133,134,137,140,142,145,148,121,121,123,121,121,124,126,126,128,130,133,134,135,137,140,142,144,145,148,151,137,121,120,121,120,120,121,124,124,124,128,131,133,134,137,141,144,147,149,152,152,154,155,154,120};

    int start = 0;
    int end = ppg_len - 1;
    while (start < end)
    {
        double temp = ppg[start];
        ppg[start] = ppg[end];
        ppg[end] = temp;
        start++;
        end--;
    }

    int sys_peaks[50] = {};
    int num_peaks = 0;
    double filtered_ppg[150];
    find_systolic_peaks(ppg, sys_peaks, &num_peaks, filtered_ppg);
    // print_peaks(sys_peaks,num_peaks);

    int fin_sys_peaks[50];
    int fin_peak_count = 0;

    // use filtered ppg for extracting features
    double save_ppg[150];
    for (int i = 0; i < ppg_len; i++)
    {
        save_ppg[i] = ppg[i];
        ppg[i] = filtered_ppg[i];
        // printf("%f,", ppg[i]);
    }
    // skip the last peak
    for (int i = 0; i < num_peaks - 1; i++)
    {
        int curr_peak = sys_peaks[i];
        while (curr_peak >= 1 && ppg[curr_peak] <= ppg[curr_peak - 1])
        {
            curr_peak--;
        }
        fin_sys_peaks[fin_peak_count++] = curr_peak;
    }

    // foot peaks
    int foot[fin_peak_count];
    int foot_idx = 0;
    int n = 150;
    for (int i = 0; i < fin_peak_count; i++)
    {
        int idx = fin_sys_peaks[i];
        while (idx >= 1 && ppg[idx] >= ppg[idx - 1])
        {
            idx = idx - 1;
        }
        foot[foot_idx++] = idx;
    }

    // print_peaks(fin_sys_peaks,fin_peak_count);

    double heart_rate = find_heart_rate(fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->hr = heart_rate;

    double ref_ind = find_refliction_index(ppg, ppg_len, fin_sys_peaks, fin_peak_count);
    my_features->ref_find = ref_ind;

    double lasi_area = find_lasi(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->lasi = lasi_area;

    double crest_time = find_crest_time(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->crest_time = crest_time;

    double mnpv = find_mnpv(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->mnpv = mnpv;

    double sys_time = find_sys_time(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->sys_time = sys_time;

    double foot_time = find_foot_time(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->foot_time = foot_time;

    double pir = find_pir(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->pir = pir;

    double aix = find_augmentation_index(ppg, ppg_len, fin_sys_peaks, num_peaks, foot);
    my_features->aix = aix;

    double pulse_height = find_pulse_height(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->pulse_height = pulse_height;

    double pulse_width = find_pulse_width(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->pulse_width = pulse_width;

    double hrv = find_hrv(ppg, fin_sys_peaks, fin_peak_count, foot);
    my_features->hrv = hrv;

    double amp_rat = find_amplitude_ratios(ppg, fin_sys_peaks, fin_peak_count, foot);
    my_features->amplitude_ratios = amp_rat;

    double max_amplitude = find_max_amplitude(ppg, ppg_len, foot);
    my_features->max_amplitude = max_amplitude;

    double min_amplitude = find_min_amplitude(ppg, ppg_len, foot);
    my_features->min_amplitude = min_amplitude;

    double wom_number = find_womersley_number(ppg, fin_sys_peaks, fin_peak_count, foot);
    my_features->womersley_number = wom_number;

    double alpha = find_alpha(ppg, fin_sys_peaks, fin_peak_count, foot);
    my_features->alpha = alpha;

    double ipa = find_ipa(ppg, ppg_len, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->ipa = ipa;

    double pwv = find_pwv(ppg, fin_sys_peaks, fin_peak_count, fs, foot);
    my_features->pwv = pwv;

    double sys_time_x = find_systolic_time_x(ppg, fin_sys_peaks, fin_peak_count, fs);
    my_features->sys_time_x = sys_time_x;
}

double relu(double x)
{
    return x > 0 ? x : 0;
}

double sigmoid(double x)
{
    return 1.0 / (1.0 + exp(-x));
}

double classifier_predict(double *input)
{

    double layer1[64];
    for (int i = 0; i < 64; ++i)
    {
        layer1[i] = 0;
        for (int j = 0; j < NUM_FEATURES; ++j)
        {
            layer1[i] += input[j] * weights_layer1[j][i];
        }
        layer1[i] += biases_layer1[i];
        layer1[i] = relu(layer1[i]);
    }

    double layer2[32];
    for (int i = 0; i < 32; ++i)
    {
        layer2[i] = 0;
        for (int j = 0; j < 64; ++j)
        {
            layer2[i] += layer1[j] * weights_layer2[j][i];
        }
        layer2[i] += biases_layer2[i];
        layer2[i] = relu(layer2[i]);
    }

    double output = 0;
    for (int i = 0; i < 1; ++i)
    {
        output = 0;
        for (int j = 0; j < 32; ++j)
        {
            output += layer2[j] * weights_output[j][i];
        }
        output += bias_output[i];
        output = sigmoid(output);
    }
    return output;
}

void standard_scaler(double data[], double mean[], double std_dev[], int n)
{
    for (int i = 0; i < n; ++i)
    {
        data[i] = (data[i] - mean[i]) / std_dev[i];
    }
}

int classifier_scaler(double input[])
{

    standard_scaler(input, mean_values, std_values, NUM_FEATURES);

    double prediction = classifier_predict(input);
    // printf("Final Pred: %f\n", prediction);
    int final_pred = prediction > 0.5 ? 1 : 0;

    return final_pred;
}

int compare_doubles(const void *a, const void *b)
{
    double arg1 = *(const double *)a;
    double arg2 = *(const double *)b;

    if (arg1 < arg2)
        return -1;
    if (arg1 > arg2)
        return 1;
    return 0;
}

double calculate_ptt(double ecg_signal[], double ppg_signal[], int ecg_len, int ppg_len, int r_peaks[], int systolic_peaks[], int *num_r_peaks, int *num_systolic_peaks, double ecg_filt[], double ppg_filt[], int bp)
{

    for (int i = 0; i < ecg_len; i++)
    {
        ecg_filt[i] = ecg_signal[i];
    }

    for (int i = 0; i < ppg_len; i++)
    {
        ppg_filt[i] = ppg_signal[i];
    }

    double fs_ecg = 233.0;
    double fs_ppg = 25.0;

    int is_ecg = 1, to_print = 0;
    *num_r_peaks = find_signal_peaks(ecg_signal, ecg_len, r_peaks, is_ecg, to_print);
    *num_systolic_peaks = find_signal_peaks(ppg_signal, ppg_len, systolic_peaks, 1 - is_ecg, to_print);

    double sum_ptt = 0.0;
    int valid_pairs = 0, num_pulse = 5;
    double store[num_pulse];
    int store_index = 0;
    for (int i = 0; i < *num_r_peaks; i++)
    {
        int closest_r_peak = -1;
        // int min_distance = 10000;
        double min_distance = INFINITY;
        for (int j = 0; j < *num_systolic_peaks; j++)
        {
            if (systolic_peaks[j] > r_peaks[i])
            {
                double distance = (systolic_peaks[j] / fs_ppg) - (r_peaks[i] / fs_ecg);
                if (distance < 0)
                {
                    distance = -1 * distance;
                }
                if (distance < min_distance)
                {
                    min_distance = distance;
                    // printf("systolic_peaks[j]: %d, r_peaks[i]: %d, min_distance: %f\n", systolic_peaks[j], r_peaks[i], min_distance);
                    closest_r_peak = j;
                }
            }
        }
        if (closest_r_peak != -1)
        {
            valid_pairs++;
            store[store_index++] = min_distance;
            // sum_ptt += (((double)min_distance / (fs_ppg * fs_ecg))) * fs_ppg;
            // sum_ptt += min_distance;
        }
    }
    qsort(store, store_index, sizeof(double), compare_doubles);
    for (int i = 0; i < (int)(store_index / 2); i++)
    {
        sum_ptt += store[i];
        valid_pairs--;
    }
    double consecutive_diff = 0.0;

    int store_ratio[num_pulse];
    for (int i = 0; i < num_pulse; i++)
    {
        int rp = r_peaks[i], sp = systolic_peaks[i];
        store_ratio[i] = 0;
        store_ratio[i] = max_peak(rp, sp) - min_peak(rp, sp);
    }
    
    int diff_30 = 0, allowed_limit = 30;
    for (int i = 1; i < num_pulse; i++)
    {
        int loc_diff = (store_ratio[i] - store_ratio[i - 1]);
        diff_30 += (loc_diff <= allowed_limit);
    }

    int consecutive_diff_result = (diff_30 >= num_pulse - 2);
    printf("BP: %d, PTT: %f, diff: %d\n", bp, sum_ptt,consecutive_diff_result);
    double ppg_is_high = 1;
    return sum_ptt;

    // printf("BP: %d, PTT: %.3f\n", bp, sum_ptt);
    // print_new_lines();

    // for (int i = 0; i < *num_r_peaks && *num_systolic_peaks; i++)
    // {
    //     int r_peak_index = r_peaks[i];
    //     int systolic_peak_index = systolic_peaks[i];

    //     if (r_peak_index >= ecg_len || systolic_peak_index >= ppg_len)
    //     {
    //         continue;
    //     }
    //     double ptt = (double)(fabs(r_peak_index - systolic_peak_index)) / (fs_ecg * fs_ppg);
    //     ptt *= fs_ppg;
    //     sum_ptt += ptt;
    //     valid_pairs++;
    // }

    // double consecutive_diff = 0.0;
    // int store[num_pulse];

    // for (int i = 0; i < num_pulse; i++)
    // {
    //     int rp = r_peaks[i], sp = systolic_peaks[i];
    //     store[i] = 0;
    //     int diff = max_peak(rp, sp) - min_peak(rp, sp);
    //     store[i] = diff;
    // }
    // int diff_30 = 0, allowed_limit = 30;
    // for (int i = 1; i < num_pulse; i++)
    // {
    //     int loc_diff = (store[i] - store[i - 1]);
    //     diff_30 += (loc_diff <= allowed_limit);
    // }

    // int consecutive_diff_result = (diff_30 >= num_pulse - 2);
    // // int allowed_limit1 = -1;
    // // if (!consecutive_diff_result)
    // // {
    // //     for (int j = 31; j <= 45; j++)
    // //     {
    // //         int diff_301 = 0;
    // //         allowed_limit1 = j;
    // //         for (int i = 1; i < num_pulse; i++)
    // //         {
    // //             int loc_diff1 = (store[i] - store[i - 1]);
    // //             diff_301 += (loc_diff1 <= allowed_limit1);
    // //         }
    // //         if (diff_301 >= num_pulse - 2)
    // //         {
    // //             consecutive_diff_result = 1;
    // //             break;
    // //         }
    // //     }
    // // }

    // double ptt_ret = (sum_ptt / valid_pairs);

    // int stuff = (consecutive_diff_result && (ptt_ret >= 0.3));

    // double pulse_amplitude = 0.0;

    // for (int i = 0; i < num_pulse; i++)
    // {
    //     int foot = systolic_peaks[i];
    //     while (foot + 1 < ppg_len && ppg_signal[foot] <= ppg_signal[foot + 1])
    //     {
    //         foot++;
    //     }

    //     double A = ppg_signal[foot], B = ppg_signal[systolic_peaks[i]];
    //     if (A > B)
    //     {
    //         pulse_amplitude += (A - B);
    //     }
    //     else
    //     {
    //         pulse_amplitude += (B - A);
    //     }
    // }

    // pulse_amplitude /= num_pulse;
    // double pulse_widths = 0.0;
    // int foot_sys_peak[num_pulse];
    // for (int i = 0; i < num_pulse; i++)
    // {
    //     int foot = systolic_peaks[i];
    //     while (foot + 1 < ppg_len && ppg_signal[foot] <= ppg_signal[foot + 1])
    //     {
    //         foot++;
    //     }
    //     int peak_index = foot;
    //     foot_sys_peak[i] = foot;
    //     double half_max = ppg_signal[peak_index] / 2.0;

    //     int left_index = peak_index;
    //     while (left_index > 0 && ppg_signal[left_index] > half_max)
    //     {
    //         left_index--;
    //     }

    //     int right_index = peak_index;
    //     while (right_index < num_pulse - 1 && ppg_signal[right_index] > half_max)
    //     {
    //         right_index++;
    //     }

    //     pulse_widths += (right_index - left_index) / fs_ppg;
    // }

    // // ###############################################################################################

    // // ################################################################################################
    // // printf("%d,",bp);
    // // printf("%f,",pulse_amplitude);
    // // printf("%f,",pulse_widths);

    // int prediction = ((pulse_amplitude >= 10 && pulse_amplitude <= 37.0) && (pulse_widths >= 6 && pulse_widths <= 13));
    // // printf("BP: %d, Prediction: %d\n", bp, prediction);

    // // printf("bp: %d, pulse_amplitude: %f, pulse_widths: %f, Prediction: %d\n", bp, pulse_amplitude, pulse_widths, prediction);
}
